<!--<div class="content">
        {% for post in paginator.posts %}
        <article class="post" data-tags="{{ post.tags | join: ' ' }}">
            
        <a href="{{ post.url | relative_url }}" class="article-title">{{ post.title }}</a>
            <div class="separator"></div>
            <p class="article-info">{{ post.date | date: "%d %B %Y" }}</p>
            
                {% assign image_found = false %}
                {% assign content_blocks = post.content | split: '&lt;img' %}
                    {% if content_blocks.size > 1 %}
                        {% assign first_image = content_blocks[1] | split: '>' | first %}
                            <img{{ first_image }}>
                                    {% endif %}
            
            {% assign excerpt = post.content | strip_html | truncatewords: 30 %}
            <p class="summary">{{ excerpt }}</p>
            </p>
        
        </article>
        {% endfor %}
    
        <div class="pagination">
                {% if paginator.previous_page %}
                    <a href="{{ paginator.previous_page_path | relative_url }}">&laquo; Précédent</a>
                {% endif %}
                {% if paginator.next_page %}
                    <a href="{{ paginator.next_page_path | relative_url }}">Suivant &raquo;</a>
                {% endif %}
        </div>
</div>
-->



<div class="content">
        <input type="text" id="search-input" placeholder="Rechercher...">

        <div id="tag-list">
            {% for tag in site.tags %}
            <input type="checkbox" id="{{ tag[0] }}" name="{{ tag[0] }}" value="{{ tag[0] }}">
            <label for="{{ tag[0] }}">{{ tag[0] }}</label>
            {% endfor %}
        </div>

        <div id="post-list">
            {% for post in paginator.posts %}
            <article class="post" data-tags="{{ post.tags | join: ' ' }}">
                
                <a href="{{ post.url | relative_url }}" class="article-title">{{ post.title }}</a>
                <div class="separator"></div>
                <p class="article-info">{{ post.date | date: "%d %B %Y" }}</p>
                
                {% assign image_found = false %}
                {% assign content_blocks = post.content | split: '<img' %}
                {% if content_blocks.size > 1 %}
                {% assign first_image = content_blocks[1] | split: '>' | first %}
                <img{{ first_image }}>
                {% endif %}
                
                {% assign excerpt = post.content | strip_html | truncatewords: 30 %}
                <p class="summary">{{ excerpt }}</p>
            
            </article>
            {% endfor %}
        </div>

        <div class="pagination">
            {% if paginator.previous_page %}
                <a href="{{ paginator.previous_page_path | relative_url }}">&laquo; Précédent</a>
            {% endif %}
            {% if paginator.next_page %}
                <a href="{{ paginator.next_page_path | relative_url }}">Suivant &raquo;</a>
            {% endif %}
        </div>
    </div>


<script>
        function filterPosts() {
            let searchQuery = $('#search-input').val().toLowerCase();
            let checkedTags = $('input[type=checkbox]:checked').map(function() {
                return this.value;
            }).get();

            let filteredPosts = $('.post').filter(function() {
                let postTags = $(this).data('tags').split(' ');
                let hasTag = checkedTags.every(tag => postTags.includes(tag));
                let postTitle = $(this).find('.article-title').text().toLowerCase();
                let searchMatch = searchQuery === "" || postTitle.includes(searchQuery);

                return hasTag && searchMatch;
            });

            if (searchQuery !== "" || checkedTags.length > 0) {
                $('.pagination').hide();
                $('.post').hide();
                filteredPosts.show();
            } else {
                $('.pagination').show();
                $('.post').hide();
                {% for post in paginator.posts %}
                $('article[data-tags="{{ post.tags | join: ' ' }}"]').show();
                {% endfor %}
            }
        }

        $(document.ready(function() {
            // Handlers d'événements
            $('#search-input').on('input', filterPosts);
            $('input[type=checkbox]').on('change', filterPosts);
        });
    </script>
